<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>ç‚¹èµ</title>
</head>
<body>
    <div class="wrapper">
        <!-- <button class="like-btn">
            <span class="like-text">ç‚¹èµ</span>
            <span>ğŸ‘</span>
        </button> -->
    </div>
    <script>
        // const button = document.querySelector('.like-btn')
        // const buttonText = button.querySelector('.like-text')
        // let isLiked = false
        // button.addEventListener('click', () => {
        //     isLiked = !isLiked
        //     if (isLiked) {
        //         buttonText.innerHTML = 'å–æ¶ˆ'
        //     } else {
        //         buttonText.innerHTML = 'ç‚¹èµ'
        //     }
        // }, false)

        // é—®é¢˜? DOMåŒ– æ›´åº•å±‚ ç°ä»£ç¼–ç¨‹å¯ä»¥å»DOMåŒ– æ„å»ºä¸€ä¸ªè™šæ‹ŸDOMç»“ç‚¹
        // react react-dom 
        // å¤ç”¨ åœ¨jsä¸­ç±»åŒ–<==>React|Vue-->Component

        // .vue .jsx éƒ½æ˜¯ä¸ºäº†æ–¹ä¾¿ ä¼˜åŠ¿å¼ºäºä¸€èˆ¬çš„ç±»åŒ– 
        // äº‹ä»¶? DOM
        // const createDOMFromString = (domString) => {
        //     const div = document.createElement('div')
        //     div.innerHTML = domString
        //     return div
        // }
        // class LikeButton {
        //     // å¦‚ä½•è¡¨è¾¾çŠ¶æ€ çŠ¶æ€æ˜¯å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ jsonå­—é¢é‡
        //     constructor () {
        //         this.state = {
        //             isLiked: false
        //         }
        //     }
        //     render () {
        //         this.el = createDOMFromString(`
        //             <button id="like-btn">
        //                 <span class="like-text">${this.state.isLiked?'å–æ¶ˆ':'ç‚¹èµ'}</span>
        //                 <span>ğŸ‘</span>
        //             </button>
        //         `)
        //         // this.el.addEventListener('click', () => console.log('cilck'), false)
        //         this.el.addEventListener('click', this.changeLikeText.bind(this), false)
        //         return this.el
        //     }
        //     setState (state) {
        //         this.state = state
        //         const oldEl = this.el
        //         // newEl
        //         this.el = this.render()
        //         if (this.onStateChange) this.onStateChange(oldEl, this.el)
        //     }
        //     changeLikeText () {
        //         this.setState({
        //             isLiked: !this.state.isLiked
        //         })
        //         // const likeText = this.el.querySelector('.like-text')
        //         // this.state.isLiked = !this.state.isLiked
        //         // å®ç°çŠ¶æ€æ”¹å˜->ç•Œé¢ä¹Ÿéšä¹‹æ”¹å˜ï¼Ÿå†æ‰§è¡Œä¸€æ¬¡render
                
        //         // likeText.innerHTML = this.state.isLiked?'å–æ¶ˆ':'ç‚¹èµ'
        //     }
        // } 
        // const wrapper = document.querySelector('.wrapper')
        // const likeButton = new LikeButton()
        // wrapper.appendChild(likeButton.render())
        // // è€çš„ç»“ç‚¹ ä»ç„¶åœ¨domä¸Š æ–°çš„ç»“ç‚¹å·²ç»å‡†å¤‡å¥½ æ²¡æœ‰æŒ‚è½½ä¸Šå»
        // likeButton.onStateChange = (oldEl, newEl) => {
        //     wrapper.insertBefore(newEl, oldEl)
        //     wrapper.removeChild(oldEl)
        // }
        // const likeButton2 = new LikeButton()
        // wrapper.innerHTML += likeButton2.render()
        // DOMç»“ç‚¹çš„éƒ¨åˆ†æ›´æ–° hot-reload
        // è™šæ‹Ÿdomæ›´æ–° ä¸€å®šå¾—æ›´æ–°å åŒæ­¥åˆ°domç»“ç‚¹
        // style.display style.fontSize style.webkitTransform
        // ç•Œé¢å°±äº§ç”Ÿäº†çŠ¶æ€ 

        const createDOMFromString = (domString) => {
            const div = document.createElement('div')
            div.innerHTML = domString
            return div
        }
        const mount = (component, wrapper) => {
            wrapper.appendChild(component._renderDOM())
            component.onStateChange = (oldEl, newEl) => {
                wrapper.insertBefore(newEl, oldEl)
                wrapper.removeChild(oldEl)
            }
        }
        class Component {
            // æœ‰å¯èƒ½ä¸ä¼  å°±ç»™ä¸ªé»˜è®¤å€¼props={}
            constructor (props={}) {
                this.props = props
                console.log('çˆ¶ç±»æ„é€ å‡½æ•°')
            }
            setState (state) {
                const oldEl = this.el
                this.state = state
                this.el = this._renderDOM()
                // åŠ¨æ€è¯­è¨€ å¯ä»¥åœ¨è¿è¡Œè¿‡ç¨‹ä¸­åŠ¨æ€æ·»åŠ æ–¹æ³•æˆ–å±æ€§
                if (this.onStateChange) {
                    this.onStateChange(oldEl, this.el)
                }
            }
            _renderDOM () {
                // å­ç±» ä¸€å®šå¾—æä¾›renderæ–¹æ³•
                // è§£æ”¾äº†render åªéœ€è¦UIï¼Œhtml
                this.el = createDOMFromString(this.render())
                if (this.onClick) {
                    this.el.addEventListener('click', this.onClick.bind(this), false)
                }
                return this.el
            }
        }
        class LikeButton extends Component {
            constructor (props) {
                super(props)
                this.state = {
                    isLiked: false
                }
            }
            onClick () {
                this.setState({
                    isLiked: !this.state.isLiked
                })
            }
            render () {
                return `
                    <button id="like-btn" style="background-color:${this.props.bgColor}">
                        <span class="like-text">${this.state.isLiked?'å–æ¶ˆ':'ç‚¹èµ'}</span>
                        <span>ğŸ‘</span>
                    </button>
                `
            }
        }
        mount(new LikeButton({bgColor: "yellow"}), document.querySelector('.wrapper'))
    </script>
</body>
</html>